#region Normal way
[int]$FizzBuzzOccurrences = 0
[int]$FizzBuzzRunningTotal = 0
[int]$FizzOccurrences = 0
[int]$FizzRunningTotal = 0
[int]$BuzzOccurrences = 0
[int]$BuzzRunningTotal = 0

# Works
1..15 | ForEach-Object {
    switch ($_) {
        { $_ % 15 -eq 0 } { ++$FizzBuzzOccurrences; $FizzBuzzRunningTotal = $FizzBuzzRunningTotal + $_; break }
        { $_ % 5 -eq 0 }  { ++$BuzzOccurrences;     $BuzzRunningTotal = $BuzzRunningTotal + $_;         break }
        { $_ % 3 -eq 0 }  { ++$FizzOccurrences;     $FizzRunningTotal = $FizzRunningTotal + $_;         break }
    }
    [PSCustomObject]@{
        Number     = $_
        Fizzed     = $FizzOccurrences
        Buzzed     = $BuzzOccurrences
        FizzBuzzed = $FizzBuzzOccurrences
        FizzRunningTotal = $FizzRunningTotal
        BuzzRunningTotal = $BuzzRunningTotal
        FizzBuzzRunningTotal = $FizzBuzzRunningTotal
    }
} | Format-Table -AutoSize
#endregion

#region Scriptblocks
[int]$FizzBuzzOccurrences = 0
[int]$FizzBuzzRunningTotal = 0
[int]$FizzOccurrences = 0
[int]$FizzRunningTotal = 0
[int]$BuzzOccurrences = 0
[int]$BuzzRunningTotal = 0
# Scriptblocks
$Mod15 = [Scriptblock]::Create('param([int]$Number)
    if ($Number % 15 -eq 0) {
        $FizzBuzzRunningTotal = $FizzBuzzRunningTotal + $_
    }')
$Mod5 = [Scriptblock]::Create('param([int]$Number)
    if ($Number % 5 -eq 0) {
        $BuzzRunningTotal = $BuzzRunningTotal + $_
    }')
$Mod3 = [Scriptblock]::Create('param([int]$Number)
    if ($Number % 3 -eq 0) {
        $FizzRunningTotal = $FizzRunningTotal + $_
    }')
1..15 | ForEach-Object {
    switch ($_) {
        { $_ % 15 -eq 0 } {++$FizzBuzzOccurrences; & $Mod15; break }
        { $_ % 5 -eq 0 }  {++$BuzzOccurrences;     & $Mod5;  break }
        { $_ % 3 -eq 0 }  {++$FizzOccurrences;     & $Mod3;  break }
    }
    [PSCustomObject]@{
        Number     = $_
        Fizzed     = $FizzOccurrences
        Buzzed     = $BuzzOccurrences
        FizzBuzzed = $FizzBuzzOccurrences
        FizzRunningTotal = $FizzRunningTotal
        BuzzRunningTotal = $BuzzRunningTotal
        FizzBuzzRunningTotal = $FizzBuzzRunningTotal
    }
} | Format-Table -AutoSize
#endregion

#region TroubleShooting
[int]$FizzBuzzOccurrences = 0
[int]$FizzBuzzRunningTotal = 0
[int]$FizzOccurrences = 0
[int]$FizzRunningTotal = 0
[int]$BuzzOccurrences = 0
[int]$BuzzRunningTotal = 0
# Scriptblocks
$Mod15 = [Scriptblock]::Create('param([int]$Number)
    if ($Number % 15 -eq 0) {
        $FizzBuzzRunningTotal + $_
    }')
$Mod5 = [Scriptblock]::Create('param([int]$Number)
    if ($Number % 5 -eq 0) {
       $BuzzRunningTotal + $_
    }')
$Mod3 = [Scriptblock]::Create('param([int]$Number)
    if ($Number % 3 -eq 0) {
       $FizzRunningTotal + $_
    }')
1..15 | ForEach-Object {
    switch ($_) {
        { $_ % 15 -eq 0 } {++$FizzBuzzOccurrences; & $Mod15; break }
        { $_ % 5 -eq 0 }  {++$BuzzOccurrences;     & $Mod5;  break }
        { $_ % 3 -eq 0 }  {++$FizzOccurrences;     & $Mod3;  break }
    }
    [PSCustomObject]@{
        Number     = $_
        Fizzed     = $FizzOccurrences
        Buzzed     = $BuzzOccurrences
        FizzBuzzed = $FizzBuzzOccurrences
        FizzRunningTotal = & $Mod3 -argumentlist $_
        BuzzRunningTotal = $BuzzRunningTotal
        FizzBuzzRunningTotal = $FizzBuzzRunningTotal
    }
} | Format-Table -AutoSize
#endregion